{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com';\nconst API_KEY = '44423269-f21c5bc9414954348df27e7dd';\n\nexport async function fetchImages(query, page = 1, per_page = 15) {\n  const END_POINT = '/api/';\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page,\n    per_page,\n  });\n\n  const url = `${BASE_URL}${END_POINT}?${params}`;\n\n  try {\n    const response = await axios.get(url);\n    if (response.status !== 200) {\n      throw new Error('Network response was not ok');\n    }\n    return response.data;\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    throw error;\n  }\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet lightbox;\n\nexport function renderGallery(images, append = false) {\n  const gallery = document.getElementById('gallery');\n  const imagesHTML = images\n    .map(\n      image => `\n      <a href=\"${image.largeImageURL}\" class=\"gallery-item\" data-lightbox=\"gallery\">\n        <div class=\"image-card\">\n          <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" />\n          <p>${image.tags}</p>\n        </div>\n      </a>\n    `\n    )\n    .join('');\n\n  if (append) {\n    gallery.insertAdjacentHTML('beforeend', imagesHTML);\n  } else {\n    gallery.innerHTML = imagesHTML;\n  }\n\n  if (!lightbox) {\n    lightbox = new SimpleLightbox('.gallery-item', {\n      /* options */\n    });\n  } else {\n    lightbox.refresh();\n  }\n}\n\nexport function showError(message) {\n  iziToast.error({\n    title: 'Error',\n    message: message,\n  });\n}\n\nexport function clearGallery() {\n  const gallery = document.getElementById('gallery');\n  gallery.innerHTML = '';\n}\n","import { fetchImages } from './js/pixabay-api';\nimport { renderGallery, showError, clearGallery } from './js/render-functions';\n\nconst loaderWrapper = document.querySelector('.loader-wrapper');\nconst loadMoreButton = document.querySelector('.load-more');\nconst endMessage = document.createElement('p');\nendMessage.textContent =\n  \"We're sorry, but you've reached the end of search results.\";\nendMessage.style.display = 'none';\ndocument.body.appendChild(endMessage);\n\nlet currentPage = 1;\nlet currentQuery = '';\nlet totalHits = 0;\n\nconst refs = {\n  form: document.querySelector('.js-picture-form'),\n  input: document.querySelector('.js-picture-form input[name=\"query\"]'),\n  gallery: document.getElementById('gallery'),\n};\n\nrefs.form.addEventListener('submit', async function (e) {\n  e.preventDefault();\n\n  const query = refs.input.value.trim();\n  if (query === '') {\n    showError('Please enter a search term');\n    return;\n  }\n\n  if (query !== currentQuery) {\n    currentQuery = query;\n    currentPage = 1;\n    totalHits = 0;\n    clearGallery();\n    loadMoreButton.style.display = 'none';\n    endMessage.style.display = 'none';\n  }\n\n  loaderWrapper.style.display = 'block';\n\n  try {\n    const data = await fetchImages(currentQuery, currentPage);\n    loaderWrapper.style.display = 'none';\n    totalHits = data.totalHits;\n\n    if (data.hits.length === 0) {\n      showError(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n    } else {\n      renderGallery(data.hits, currentPage > 1);\n      if (currentPage * 15 < totalHits) {\n        loadMoreButton.style.display = 'block';\n      } else {\n        loadMoreButton.style.display = 'none';\n        endMessage.style.display = 'block';\n      }\n      if (currentPage > 1) {\n        scrollToNextGroup();\n      }\n    }\n  } catch (error) {\n    loaderWrapper.style.display = 'none';\n    showError('An error occurred while fetching the images. Please try again.');\n  }\n});\n\nloadMoreButton.addEventListener('click', async function () {\n  currentPage += 1;\n  loaderWrapper.style.display = 'block';\n\n  try {\n    const data = await fetchImages(currentQuery, currentPage);\n    loaderWrapper.style.display = 'none';\n    renderGallery(data.hits, true);\n\n    if (currentPage * 15 >= totalHits) {\n      loadMoreButton.style.display = 'none';\n      endMessage.style.display = 'block';\n    }\n    scrollToNextGroup();\n  } catch (error) {\n    loaderWrapper.style.display = 'none';\n    showError('An error occurred while fetching the images. Please try again.');\n  }\n});\n\nfunction getCardHeight() {\n  const gallery = document.querySelector('#gallery');\n  const card = gallery.querySelector('.image-card');\n  return card ? card.getBoundingClientRect().height : 0;\n}\n\nfunction scrollToNextGroup() {\n  const cardHeight = getCardHeight();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["BASE_URL","API_KEY","fetchImages","query","page","per_page","END_POINT","params","url","response","axios","error","lightbox","renderGallery","images","append","gallery","imagesHTML","image","SimpleLightbox","showError","message","iziToast","clearGallery","loaderWrapper","loadMoreButton","endMessage","currentPage","currentQuery","totalHits","refs","e","data","scrollToNextGroup","getCardHeight","card","cardHeight"],"mappings":"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"}